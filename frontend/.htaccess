# URL Rewriting for Epic EHR Frontend
# Enables clean URLs and API proxying

RewriteEngine On

# Don't proxy local PHP API files - let them be handled directly
RewriteCond %{REQUEST_URI} ^/api/.*\.php$
RewriteRule .* - [L]

# Proxy API requests to Python backend (only non-PHP API calls)
RewriteCond %{REQUEST_URI} ^/api/
RewriteCond %{REQUEST_URI} !\.php$
RewriteRule ^api/(.*)$ http://localhost:5000/api/$1 [P,L]

# Don't rewrite actual files or directories
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Handle pretty URLs
RewriteRule ^patient/([0-9]+)$ index.php?patient_id=$1 [QSA,L]
RewriteRule ^activity/([a-z-]+)/([0-9]+)$ activities/$1.php?patient_id=$2 [QSA,L]
